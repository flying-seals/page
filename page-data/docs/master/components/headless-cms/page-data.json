{"componentChunkName":"component---src-views-docs-index-tsx","path":"/docs/master/components/headless-cms","webpackCompilationHash":"aefb7e842b40c338951f","result":{"pageContext":{"isCreatedByStatefulCreatePages":false,"version":"master","versions":{"releases":["0.9"],"prereleases":["1.0"],"branches":["master"]},"content":{"id":"headless-cms","displayName":"Headless CMS","description":"Overall documentation for Headless CMS","type":"components","docs":[{"order":"01-01-headless-cms","title":"Overview","source":"\nThe Headless CMS is a new breed of traditional Content Management Systems (CMS) that provides a way of storing and managing raw content, and exposing it through an API. It allows you to pull the content into your own application and tailor it to your needs, delivering it in any format, on any device. Contrary to the traditional CMS, such as WordPress, the Headless CMS does not provide a display layer and ready-to-use templates. Instead, it only ensures a database backend. It gives flexibility on the choice of the frontend, thus cutting the default \"head\" off the traditional CMS solutions.\n\n## Headless CMS in Kyma\n\nKyma provides a Kubernetes-based solution that relies on the custom resource (CR) extensibility feature and the [Asset Store](/docs/master/components/asset-store/#overview-overview) as a backend mechanism. The Headless CMS in Kyma allows you to upload multiple and grouped data for a given documentation topic and store them as Asset CRs in Minio buckets. All you need to do is to specify all topic details, such as documentation sources, in a DocsTopic CR or a ClusterDocsTopic CR and apply it to a given Namespace or a cluster. The CR supports various documentation formats, including images, Markdown documents, [AsyncAPI](https://www.asyncapi.com/), [OData](https://www.odata.org/), and [OpenAPI](https://www.openapis.org/) specification files. You can upload them as single (direct file URLs) and packed assets (ZIP or TAR).\n\n## Benefits\n\nThe Headless CMS brings a number of benefits:\n\n- It provides a unified way of uploading different document types to a Kyma cluster.\n- It fits into the Kyma modularity concept as you load onto a cluster only documentation for the installed components. This is possible as the DocsTopic CR and the code for a given component are located in the same place in the `kyma` repository.\n- It supports baked-in documentation. Apart from the default documentation, you can add your own and group it as you like, the same way you use micro frontends to personalize views in the Console UI. For example, you can add contextual help for a given Service Broker in the Service Catalog.\n"},{"order":"02-01-headless-cms","title":"Architecture","source":"\n## Resources\n\nThe Headless CMS in Kyma consists of these components:\n\n- **DocsTopic custom resource** (CR) orchestrates the creation of multiple Asset CRs for a specific documentation topic in a given Namespace. It has a cluster-wide counterpart called **ClusterDocsTopic CR**.\n\n- **DocsTopic Controller** creates Asset custom resources (CRs) based on the DocsTopic CR definition. If the DocsTopic CR defines two sources of documentation topics, such as `asyncapi` and `markdown`, the DocsTopic Controller creates two Asset CRs.\nThe DocsTopic Controller also monitors the status of the Asset CR and updates the status of the DocsTopic CR accordingly.\n\n## Headless CMS flow\n\nSee the diagram for an overview of the basic Headless CMS workflow.\n\n>**NOTE:** This flow also applies to the ClusterDocsTopic CR.\n\n![](./assets/headless-cms-architecture.svg)\n\n1. The Kyma user creates a DocsTopic CR in a given Namespace.\n2. The DocsTopic Controller reads the DocsTopic CR definition.\n3. The DocsTopic Controller checks if the [Bucket CR](/docs/master/components/asset-store/#details-bucket-custom-resource-lifecycle) already exists in this Namespace. If it does not exist yet, the DocsTopic Controller creates a new Bucket CR with the `cms-public-{suffix}` name, where `{suffix}` is a randomly generated string.\n4. The DocsTopic Controller creates Asset CRs in the number corresponding to the number of sources specified in the DocsTopic CR. It adds **cms.kyma-project.io/type** and **cms.kyma-project.io/docs-topic** labels to every Asset CR definition. It also adds the bucket name under the **bucketRef** field to every Asset CR definition.\n5. The DocsTopic Controller verifies if the Asset CRs are in the `Ready` phase and updates the status of the DocsTopic CR accordingly.\n"},{"order":"03-01-headless-cms-in-console","title":"Headless CMS in the Console","source":"\nHeadless CMS in Kyma is a separate component and does not provide templates or a standalone UI to display content from the CMS. Still, the Console UI displays some of the assets in the Docs view (generic and component-related documentation) and the Service Catalog views (API specifications).\n\nAdd a new documentation topic to the Console UI by creating a CR, while the [Asset Store](/docs/master/components/asset-store/#overview-overview) handles the rest. Define the location, grouping, and order of the documents through DocsTopic and ClusterDocsTopic labels that you add to the custom resource definition. You can create your own labels and follow your own naming convention, but **cms.kyma-project.io/{label-name}** applies to the Console UI.\n\nUse these labels to mark and filter assets in the Console UI:\n\n- **cms.kyma-project.io/view-context** specifies the location in the Console UI to render the given asset. This can be either `docs-ui` or `service-catalog`.\n- **cms.kyma-project.io/group-name** defines the group, such as `components`, under which you want to render the given asset under the `docs-ui` view in the Console UI. The value cannot include spaces.\n- **cms.kyma-project.io/order** specifies the position of the DocsTopic and ClusterDocsTopic in relation to other DocsTopics under the `docs-ui` view in the Console UI. For example, this can be `4`.\n","type":"Details"},{"order":"03-02-docstopic-cr-lifecycle","title":"DocsTopic custom resource lifecycle","source":"\n>**NOTE:** This lifecycle also applies to the ClusterDocsTopic CR.\n\n## Asset CR manual changes\n\nThe DocsTopic custom resource (CR) coordinates Asset CR creation, deletion, and modifications. The DocsTopic Controller verifies DocsTopic definition on a regular basis and creates, deletes, or modifies Assets CRs accordingly.\n\nThe DocsTopic CR acts as the only source of truth for the Asset CRs it orchestrates. If you modify or remove any of them manually, DocsTopic Controller automatically overwrites such an Asset CR or updates it based on the DocsTopic CR definition.\n\n##  DocsTopic CR and Asset CR dependencies\n\nAsset CRs and DocsTopic CRs are also interdependent in terms of names, definitions, and statuses.\n\n### Names\n\nThe name of every Asset CR created by the DocsTopic Controller consists of these three elements:\n\n- The name of the DocsTopic CR, such as `service-catalog`.\n- The source type of the given asset in the DocsTopic CR, such as `asyncapi`.\n- A randomly generated string, such as `1b38grj5vcu1l`.\n\nThe full name of such an Asset CR that follows the **{docsTopic-name}-{asset-source}-{suffix}** pattern is **service-catalog-asyncapi-1b38grj5vcu1l**.\n\n### Labels\n\nThere are two labels in every Asset CR created from DocsTopic CRs. Both of them are based on DocsTopic CRs definitions:\n\n- **cms.kyma-project.io/type** equals a given **type** parameter from the DocsTopic CR, such as `asyncapi`.\n\n- **cms.kyma-project.io/docs-topic** equals the **name** metadata from the DocsTopic CR, such as `service-catalog`.\n\n### Statuses\n\nThe status of the DocsTopic CR depends heavily on the status phase of all Asset CRs it creates. It is:\n\n- `Ready` when all related Asset CRs are already in the `Ready` phase.\n- `Pending` when it awaits the confirmation that all related Asset CRs are in the `Ready` phase. If any Asset CR is in the `Failed` phase, the status of the DocsTopic CR remains `Pending`.\n- `Failed` when processing of the DocsTopic CR fails. For example, the DocsTopic CR can fail if you provide incorrect or duplicated data in its specification.\n","type":"Details"},{"order":"06-01-docstopic","title":"DocsTopic","source":"\nThe `docstopics.cms.kyma-project.io` CustomResourceDefinition (CRD) is a detailed description of the kind of data and the format used to define an orchestrator that creates Asset CRs for a specific asset type. To get the up-to-date CRD and show the output in the `yaml` format, run this command:\n\n```\nkubectl get crd docstopics.cms.kyma-project.io -o yaml\n```\n\n## Sample custom resource\n\nThis is a sample DocsTopic custom resource (CR) that provides details of the Asset CRs for the **markdown**, **asyncapi**, and **openapi** source types.\n\n```\napiVersion: cms.kyma-project.io/v1alpha1\nkind: DocsTopic\nmetadata:\n  name: slack\n  labels:\n    cms.kyma-project.io/view-context: service-catalog\nspec:\n  displayName: Slack\n  description: \"Slack documentation\"\n  sources:\n    - type: markdown\n      name: markdown-slack\n      mode: single\n      url: https://raw.githubusercontent.com/slackapi/slack-api-specs/master/README.md\n    - type: asyncapi\n      name: asyncapi-slack\n      mode: single\n      url: https://raw.githubusercontent.com/slackapi/slack-api-specs/master/events-api/slack_events_api_async_v1.json\n    - type: openapi\n      name: openapi-slack\n      mode: single\n      url: https://raw.githubusercontent.com/slackapi/slack-api-specs/master/web-api/slack_web_openapi_v2.json\nstatus:\n  lastHeartbeatTime: \"2019-03-18T13:42:55Z\"\n  message: Assets are ready to use\n  phase: Ready\n  reason: AssetsReady\n```\n\n## Custom resource parameters\n\nThis table lists all possible parameters of a given resource together with their descriptions:\n\n\n| Parameter   |      Mandatory      |  Description |\n|----------|:-------------:|------|\n| **metadata.name** |    **YES**   | Specifies the name of the CR. It also defines the **cms.kyma-project.io/docs-topic** label added to the Asset CR that the DocsTopic CR defines. Because of label name limitations, DocsTopic CR names can have a maximum length of 63 characters. |\n| **metadata.labels** |    **NO**   | Specifies how to filter and group Asset CRs that the DocsTopic CR defines. See [this](#details-headless-cms-in-console) document for more details. |\n| **spec.displayname** |    **YES**   | Specifies a human-readable name of the DocsTopic CR. |\n| **spec.description** |    **YES**   | Provides more details on the purpose of the DocsTopic CR. |\n| **spec.sources** |    **YES**   | Defines the type of the asset and the **cms.kyma-project.io/type** label added to the Asset CR.  |\n| **spec.sources.type** |    **YES**   | Specifies the type of assets included in the DocsTopic CR. |\n| **spec.sources.name** |    **YES**   | Defines an identifier of a given asset. It must be unique if there is more than one asset of a given type in a DocsTopic CR. |\n| **spec.sources.mode** |    **YES**   | Specifies if the asset consists of one file or a set of compressed files in the ZIP or TAR format. Use `single` for one file and `package` for a set of files.  |\n| **spec.sources.url** |    **YES**   | Specifies the location of a single file or a package. |\n| **spec.sources.filter** |    **NO**   | Specifies a set of assets from the package to upload. The regex used in the filter must be [RE2](https://golang.org/s/re2syntax)-compliant. |\n| **status.lastheartbeattime** |    **Not applicable**   | Provides the last time when the DocsTopic Controller processed the DocsTopic CR. |\n| **status.message** |    **Not applicable**   | Describes a human-readable message on the CR processing progress, success, or failure. |\n| **status.phase** |    **Not applicable**   | The DocsTopic Controller adds it to the DocsTopic CR. It describes the status of processing the DocsTopic CR by the DocsTopic Controller. It can be `Ready`, `Pending`, or `Failed`. |\n| **status.reason** |    **Not applicable**   | Provides the reason why the DocsTopic CR processing succeeded, is pending, or failed.  |\n\n> **NOTE:** The DocsTopic Controller automatically adds all parameters marked as **Not applicable** to the DocsTopic CR.\n\n## Related resources and components\n\nThese are the resources related to this CR:\n\n| Custom resource |   Description |\n|:----------:|:------|\n| Asset |  The DocsTopic CR orchestrates the creation of the Asset CR and defines its content. |\n\nThese components use this CR:\n\n| Component   |   Description |\n|:----------:|:------|\n| Asset Store | Manages Asset CRs created based on the definition in the DocsTopic CR. |\n","type":"Custom Resource"},{"order":"06-02-clusterdocstopic","title":"ClusterDocsTopic","source":"\nThe `clusterdocstopics.cms.kyma-project.io` CustomResourceDefinition (CRD) is a detailed description of the kind of data and the format used to define an orchestrator that creates ClusterAsset CRs for a specific asset type. To get the up-to-date CRD and show the output in the `yaml` format, run this command:\n\n```\nkubectl get crd clusterdocstopics.cms.kyma-project.io -o yaml\n```\n\n## Sample custom resource\n\nThis is a sample ClusterDocsTopic custom resource (CR) that provides details of the ClusterAsset CR for the **markdown** source type.\n\n```\napiVersion: cms.kyma-project.io/v1alpha1\nkind: ClusterDocsTopic\nmetadata:\n  name: service-mesh\n  labels:\n    cms.kyma-project.io/view-context: docs-ui\n    cms.kyma-project.io/group-name: components\n    cms.kyma-project.io/order: \"6\"\nspec:\n  displayName: \"Service Mesh\"\n  description: \"Overall documentation for Service Mesh\"\n  sources:\n    - type: markdown\n      name: docs\n      mode: package\n      url: https://github.com/kyma-project/kyma/archive/master.zip\n      filter: /docs/service-mesh/docs/\nstatus:\n  lastHeartbeatTime: \"2019-03-18T13:42:55Z\"\n  message: Assets are ready to use\n  phase: Ready\n  reason: AssetsReady\n\n```\n\n## Custom resource parameters\n\nThis table lists all possible parameters of a given resource together with their descriptions:\n\n\n| Parameter   |      Mandatory      |  Description |\n|----------|:-------------:|------|\n| **metadata.name** |    **YES**   | Specifies the name of the CR. It also defines the **cms.kyma-project.io/docs-topic** label added to the ClusterAsset CR that the ClusterDocsTopic CR defines. Because of label name limitations, ClusterDocsTopic CR names can have a maximum length of 63 characters. |\n| **metadata.labels** |    **NO**   | Specifies how to filter and group ClusterAsset CRs that the ClusterDocsTopic CR defines. See [this](#details-headless-cms-in-console) document for more details. |\n| **spec.displayname** |    **YES**   | Specifies a human-readable name of the ClusterDocsTopic CR. |\n| **spec.description** |    **YES**   | Provides more details on the purpose of the ClusterDocsTopic CR. |\n| **spec.sources** |    **YES**   | Defines the type of the asset and the **cms.kyma-project.io/type** label added to the ClusterAsset CR.  |\n| **spec.sources.type** |    **YES**   | Specifies the type of assets included in the ClusterDocsTopic CR. |\n| **spec.sources.name** |    **YES**   | Defines a unique identifier of a given asset. It must be unique if there is more than one asset of a given type in a ClusterDocsTopic CR. |\n| **spec.sources.mode** |    **YES**   | Specifies if the asset consists of one file or a set of compressed files in the ZIP or TAR format. Use `single` for one file and `package` for a set of files.  |\n| **spec.sources.url** |    **YES**   | Specifies the location of a single file or a package. |\n| **spec.sources.filter** |    **NO**   | Specifies a set of assets from the package to upload. The regex used in the filter must be [RE2](https://golang.org/s/re2syntax)-compliant. |\n| **status.lastheartbeattime** |    **Not applicable**   | Provides the last time when the DocsTopic Controller processed the ClusterDocsTopic CR. |\n| **status.message** |    **Not applicable**   | Describes a human-readable message on the CR processing progress, success, or failure. |\n| **status.phase** |    **Not applicable**   | The DocsTopic Controller adds it to the ClusterDocsTopic CR. It describes the status of processing the ClusterDocsTopic CR by the DocsTopic Controller. It can be `Ready`, `Pending`, or `Failed`. |\n| **status.reason** |    **Not applicable**   | Provides the reason why the ClusterDocsTopic CR processing succeeded, is pending, or failed.  |\n\n> **NOTE:** The DocsTopic Controller automatically adds all parameters marked as **Not applicable** to the ClusterDocsTopic CR.\n\n## Related resources and components\n\nThese are the resources related to this CR:\n\n| Custom resource |   Description |\n|:----------:|:------|\n| ClusterAsset | The ClusterDocsTopic CR orchestrates the creation of the ClusterAsset CR and defines its content. |\n\nThese components use this CR:\n\n| Component   |   Description |\n|:----------:|:------|\n| Asset Store |  Manages ClusterAsset CRs created based on the definition in the ClusterDocsTopic CR. |\n","type":"Custom Resource"}]},"navigation":{"root":[{"displayName":"Kyma","id":"kyma"}],"components":[{"displayName":"Security","id":"security"},{"displayName":"Service Catalog","id":"service-catalog"},{"displayName":"Helm Broker","id":"helm-broker"},{"displayName":"Application Connector","id":"application-connector"},{"displayName":"Event Bus","id":"event-bus"},{"displayName":"Service Mesh","id":"service-mesh"},{"displayName":"Serverless","id":"serverless"},{"displayName":"Monitoring","id":"monitoring"},{"displayName":"Tracing","id":"tracing"},{"displayName":"API Gateway","id":"api-gateway"},{"displayName":"Logging","id":"logging"},{"displayName":"Backup","id":"backup"},{"displayName":"Console","id":"console"},{"displayName":"Asset Store","id":"asset-store"},{"displayName":"Headless CMS","id":"headless-cms"}]},"manifest":{"root":[{"displayName":"Kyma","id":"kyma"}],"components":[{"displayName":"Security","id":"security"},{"displayName":"Service Catalog","id":"service-catalog"},{"displayName":"Helm Broker","id":"helm-broker"},{"displayName":"Application Connector","id":"application-connector"},{"displayName":"Event Bus","id":"event-bus"},{"displayName":"Service Mesh","id":"service-mesh"},{"displayName":"Serverless","id":"serverless"},{"displayName":"Monitoring","id":"monitoring"},{"displayName":"Tracing","id":"tracing"},{"displayName":"API Gateway","id":"api-gateway"},{"displayName":"Logging","id":"logging"},{"displayName":"Backup","id":"backup"},{"displayName":"Console","id":"console"},{"displayName":"Asset Store","id":"asset-store"},{"displayName":"Headless CMS","id":"headless-cms"}]},"assetsPath":"/assets/docs/master/headless-cms/docs/assets/","docsType":"components","topic":"headless-cms","slidesBanner":{"bannerDuration":5000,"slides":[{"text":"Don't miss the session by Piotr Kopczynski at Helm Summit on September 11 at 15:47.","url":"https://helmsummit2019.sched.com/event/S8sS","startDate":"09/09/2019","endDate":"12/09/2019"}]},"locale":"en"}}}